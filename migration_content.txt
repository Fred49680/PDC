INSERT INTO absences (
    ressource_id, site, date_debut, date_fin, type, competence, commentaire,
    validation_saisie, date_saisie, statut
)
SELECT 
    r.id,
    'BELLEVILLE',
    '2026-01-02'::date,
    '2026-01-02'::date,
    'CP',
    'IEG',
    NULL,
    'Non',
    NOW()::timestamp,
    'Actif'
FROM ressources r
WHERE r.nom = 'APPELBAUM Vianney'
AND NOT EXISTS (
    SELECT 1 FROM absences a 
    WHERE a.ressource_id = r.id 
    AND a.date_debut = '2026-01-02'::date 
    AND a.date_fin = '2026-01-02'::date
    AND a.type = 'CP'
);
INSERT INTO absences (
    ressource_id, site, date_debut, date_fin, type, competence, commentaire,
    validation_saisie, date_saisie, statut
)
SELECT 
    r.id,
    'BELLEVILLE',
    '2026-01-02'::date,
    '2026-01-02'::date,
    'CP',
    'IEG',
    NULL,
    'Non',
    NOW()::timestamp,
    'Actif'
FROM ressources r
WHERE r.nom = 'AUFRERE Didier'
AND NOT EXISTS (
    SELECT 1 FROM absences a 
    WHERE a.ressource_id = r.id 
    AND a.date_debut = '2026-01-02'::date 
    AND a.date_fin = '2026-01-02'::date
    AND a.type = 'CP'
);
INSERT INTO absences (
    ressource_id, site, date_debut, date_fin, type, competence, commentaire,
    validation_saisie, date_saisie, statut
)
SELECT 
    r.id,
    'CHINON',
    '2026-01-02'::date,
    '2026-01-02'::date,
    'CP',
    'TRACAGE',
    NULL,
    'Non',
    NOW()::timestamp,
    'Actif'
FROM ressources r
WHERE r.nom = 'BERTAULT Frédéric'
AND NOT EXISTS (
    SELECT 1 FROM absences a 
    WHERE a.ressource_id = r.id 
    AND a.date_debut = '2026-01-02'::date 
    AND a.date_fin = '2026-01-02'::date
    AND a.type = 'CP'
);
INSERT INTO absences (
    ressource_id, site, date_debut, date_fin, type, competence, commentaire,
    validation_saisie, date_saisie, statut
)
SELECT 
    r.id,
    'DAMPIERRE',
    '2026-01-02'::date,
    '2026-01-02'::date,
    'CP',
    'PACK',
    NULL,
    'Non',
    NOW()::timestamp,
    'Actif'
FROM ressources r
WHERE r.nom = 'BERTHEAU Anthony'
AND NOT EXISTS (
    SELECT 1 FROM absences a 
    WHERE a.ressource_id = r.id 
    AND a.date_debut = '2026-01-02'::date 
    AND a.date_fin = '2026-01-02'::date
    AND a.type = 'CP'
);
INSERT INTO absences (
    ressource_id, site, date_debut, date_fin, type, competence, commentaire,
    validation_saisie, date_saisie, statut
)
SELECT 
    r.id,
    'DAMPIERRE',
    '2026-01-02'::date,
    '2026-01-02'::date,
    'CP',
    'IEG',
    NULL,
    'Non',
    NOW()::timestamp,
    'Actif'
FROM ressources r
WHERE r.nom = 'BERTRAND Antoine'
AND NOT EXISTS (
    SELECT 1 FROM absences a 
    WHERE a.ressource_id = r.id 
    AND a.date_debut = '2026-01-02'::date 
    AND a.date_fin = '2026-01-02'::date
    AND a.type = 'CP'
);
INSERT INTO absences (
    ressource_id, site, date_debut, date_fin, type, competence, commentaire,
    validation_saisie, date_saisie, statut
)
SELECT 
    r.id,
    'GOLFECH',
    '2026-01-02'::date,
    '2026-01-02'::date,
    'CP',
    'ADMIN',
    NULL,
    'Non',
    NOW()::timestamp,
    'Actif'
FROM ressources r
WHERE r.nom = 'BONGIOVANNI F.'
AND NOT EXISTS (
    SELECT 1 FROM absences a 
    WHERE a.ressource_id = r.id 
    AND a.date_debut = '2026-01-02'::date 
    AND a.date_fin = '2026-01-02'::date
    AND a.type = 'CP'
);
INSERT INTO absences (
    ressource_id, site, date_debut, date_fin, type, competence, commentaire,
    validation_saisie, date_saisie, statut
)
SELECT 
    r.id,
    'BLAYAIS',
    '2026-01-02'::date,
    '2026-01-02'::date,
    'CP',
    'SERRURERIE',
    NULL,
    'Non',
    NOW()::timestamp,
    'Actif'
FROM ressources r
WHERE r.nom = 'BOULINEAU Damien'
AND NOT EXISTS (
    SELECT 1 FROM absences a 
    WHERE a.ressource_id = r.id 
    AND a.date_debut = '2026-01-02'::date 
    AND a.date_fin = '2026-01-02'::date
    AND a.type = 'CP'
);
INSERT INTO absences (
    ressource_id, site, date_debut, date_fin, type, competence, commentaire,
    validation_saisie, date_saisie, statut
)
SELECT 
    r.id,
    'DAMPIERRE',
    '2026-01-02'::date,
    '2026-01-02'::date,
    'CP',
    'PACK',
    NULL,
    'Non',
    NOW()::timestamp,
    'Actif'
FROM ressources r
WHERE r.nom = 'BOUSSIKHANI Khalid'
AND NOT EXISTS (
    SELECT 1 FROM absences a 
    WHERE a.ressource_id = r.id 
    AND a.date_debut = '2026-01-02'::date 
    AND a.date_fin = '2026-01-02'::date
    AND a.type = 'CP'
);
INSERT INTO absences (
    ressource_id, site, date_debut, date_fin, type, competence, commentaire,
    validation_saisie, date_saisie, statut
)
SELECT 
    r.id,
    'CHINON',
    '2026-01-02'::date,
    '2026-01-02'::date,
    'CP',
    'INSTRUM',
    NULL,
    'Non',
    NOW()::timestamp,
    'Actif'
FROM ressources r
WHERE r.nom = 'CARRE Steven'
AND NOT EXISTS (
    SELECT 1 FROM absences a 
    WHERE a.ressource_id = r.id 
    AND a.date_debut = '2026-01-02'::date 
    AND a.date_fin = '2026-01-02'::date
    AND a.type = 'CP'
);
INSERT INTO absences (
    ressource_id, site, date_debut, date_fin, type, competence, commentaire,
    va